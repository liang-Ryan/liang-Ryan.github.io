"use strict";(self["webpackChunksmart_shopping"]=self["webpackChunksmart_shopping"]||[]).push([[77],{8077:function(t,e,a){a.r(e),a.d(e,{default:function(){return C}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-content"},[e("van-nav-bar",{attrs:{title:"我的订单","left-arrow":""},on:{"click-left":function(e){return t.$router.go(-1)}}}),e("van-tabs",{model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[e("van-tab",{attrs:{title:"全部",name:"all"}}),e("van-tab",{attrs:{title:"待支付",name:"payment"}}),e("van-tab",{attrs:{title:"待发货",name:"delivery"}}),e("van-tab",{attrs:{title:"待收货",name:"received"}}),e("van-tab",{attrs:{title:"待评价",name:"comment"}})],1),t._l(t.list,(function(t){return e("OrderListItem",{key:t.order_id,attrs:{item:t}})})),0===t.list.length?e("div",{staticClass:"order-none"},[t._v("暂无订单信息")]):t._e()],2)},i=[],r=a(5720);const o=(t,e)=>r.A.get("/order/list",{params:{dataType:t,page:e}}),n=t=>r.A.post("/order/receipt",{orderId:t}),l=t=>r.A.post("/order/cancel",{orderId:t});var d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"order-list-item"},[e("div",{staticClass:"title"},[e("div",{staticClass:"time"},[t._v(t._s(t.item.pay_time))]),e("div",{staticClass:"red"},[e("span",[t._v(t._s(t.item.state_text))])])]),e("div",{staticClass:"list"},t._l(t.item.goods,(function(a){return e("div",{key:a.goods_id,staticClass:"list-item"},[e("div",{staticClass:"goods-img"},[e("img",{attrs:{src:a.goods_image,alt:""}})]),e("div",{staticClass:"goods-content text-ellipsis"},[t._v(t._s(a.goods_name))]),e("div",{staticClass:"goods-trade"},[e("p",[t._v("¥ "+t._s(a.total_price))]),e("p",[t._v("x "+t._s(a.total_num))])])])})),0),e("div",{staticClass:"total"},[t._v(" 共"+t._s(t.orderTotalNum)+"件商品，总金额 ¥ "+t._s(t.item.total_price)+" ")]),e("div",{staticClass:"btn"},["待支付"===t.item.state_text?e("span",[t._v("立刻付款")]):t._e(),"待发货"===t.item.state_text?e("span",{on:{click:function(e){return t.cancelOrder(t.item.order_id)}}},[t._v("申请取消")]):t._e(),"待收货"===t.item.state_text?e("span",{on:{click:function(e){return t.receiptOrder(t.item.order_id)}}},[t._v("确认收货")]):t._e(),"已完成"===t.item.state_text?e("span",[t._v("评价")]):t._e()])])},c=[],m={props:["item"],data(){return{reloadimeout:""}},computed:{orderTotalNum(){return this.item.goods.reduce(((t,e)=>t+e.total_num),0)}},methods:{async receiptOrder(t){const{message:e}=await n(t);this.$toast(e),this.reload()},async cancelOrder(t){const{message:e}=await l(t);this.$toast(e),this.reload()},reload(){this.reloadimeout=setTimeout((()=>{location.reload()}),1e3)}},destroyed(){clearTimeout(this.reloadimeout)}},_=m,v=a(1656),u=(0,v.A)(_,d,c,!1,null,"3e8e34cb",null),p=u.exports,h={name:"orderIndex",components:{OrderListItem:p},created(){this.getList(this.active,this.page)},data(){return{active:this.$route.query.orderType||"all",list:[],page:1}},methods:{async getList(t,e){const{data:{list:{data:a}}}=await o(t,e);this.list=a}},watch:{active:{immediate:!0,handler(){this.getList(this.active,this.page)}}}},g=h,f=(0,v.A)(g,s,i,!1,null,"61d04b65",null),C=f.exports}}]);
//# sourceMappingURL=77.e1da78d4.js.map